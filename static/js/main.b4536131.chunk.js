(this["webpackJsonpiris-template"]=this["webpackJsonpiris-template"]||[]).push([[0],{106:function(e,t,r){e.exports=r(150)},134:function(e,t,r){},136:function(e,t,r){},137:function(e,t,r){},138:function(e,t,r){},139:function(e,t,r){},141:function(e,t,r){},142:function(e,t,r){},146:function(e,t,r){},147:function(e,t,r){},149:function(e,t,r){},150:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(58),c=r.n(o),i=r(5),s=r(80),u=r.n(s),l=r(99),d=r.n(l),m=u.a.create({baseURL:"".concat(window.location.host.includes("localhost")?"http://localhost:8086":window.location.host.includes("127.0.0.1")?"http://127.0.0.1:8086":"","/api/v2"),timeout:1e3,withCredentials:!0}),f={login:"test"},h="iris-template:fake-login",g=new d.a(m,{delayResponse:1500});g.onGet("/login/user").reply((function(){return"true"===localStorage.getItem(h)?[200,f]:[401]})),g.onPost("/login",{login:"test",password:"test"}).reply((function(){return console.log("[fake] user is logging"),localStorage.setItem(h,"true"),[200]})),g.onPost("/logout").reply((function(){return localStorage.removeItem(h),[200]}));var v=r(11),p=r(42),b=r(37),E=function(){function e(t,r,n,a){Object(p.a)(this,e),this._inProcess=void 0,this._data=void 0,this._error=void 0,this._timerID=void 0,this._inProcess=t,this._error=n,this._data=r,this._timerID=a}return Object(b.a)(e,[{key:"inProcess",get:function(){return this._inProcess}},{key:"data",get:function(){return this._data}},{key:"error",get:function(){return this._error}}]),Object(b.a)(e,[{key:"toProcess",value:function(){return e.createProcess()}},{key:"toProcessWithRetry",value:function(t,r){return new e(!0,void 0,void 0,window.setTimeout(t,r))}},{key:"toSuccess",value:function(t){return this._timerID&&(clearTimeout(this._timerID),this._timerID=void 0),e.createSuccess(t)}},{key:"toFailed",value:function(t){return this._timerID&&(clearTimeout(this._timerID),this._timerID=void 0),e.createFailed(t)}},{key:"map",value:function(t){return this.data?new e(this.inProcess,t(this.data),this.error):this}}],[{key:"create",value:function(){return new e(!1)}},{key:"createProcess",value:function(){return new e(!0)}},{key:"createSuccess",value:function(t){return new e(!1,t)}},{key:"createFailed",value:function(t){return new e(!1,void 0,t)}},{key:"merge2",value:function(t,r){return new e(t.inProcess||r.inProcess,t.data&&r.data&&[t.data,r.data],t.error||r.error)}},{key:"merge3",value:function(t,r,n){return new e(t.inProcess||r.inProcess||n.inProcess,t.data&&r.data&&n.data&&[t.data,r.data,n.data],t.error||r.error||n.error)}}]),e}(),_=r(69),w={user:E.create(),authorized:!1,authRequested:!1,login:E.create(),logout:E.create()},y=Object(_.b)({name:"auth",initialState:w,reducers:{getCurrentUserProcess:function(e){e.user=e.user.toProcess()},getCurrentUserSuccess:function(e,t){e.authorized=!0,e.authRequested=!0,e.user=e.user.toSuccess(t.payload)},getCurrentUserFailed:function(e,t){e.authorized=!1,e.authRequested=!0,e.user=e.user.toFailed(t.payload)},setUnauthorized:function(e){e.authorized=!1,e.authRequested=!0,e.user=E.create()},loginProcess:function(e){e.login=e.login.toProcess()},loginSuccess:function(e){e.login=e.login.toSuccess(),e.authorized=!0,e.authRequested=!0},loginFailed:function(e,t){e.login=e.login.toFailed(t.payload),e.user=E.create()},logoutProcess:function(e){e.logout=e.login.toProcess()},logoutSuccess:function(e){e.logout=e.logout.toSuccess(),e.user=E.create(),e.authorized=!1,e.authRequested=!1},logoutFailed:function(e,t){e.logout=e.login.toFailed(t.payload)}}}),j=y.reducer,O=y.actions,k=function(e){var t=function(e){"?continue=".concat(encodeURIComponent(window.location.href));return"".concat(e)}("/login");e(O.setUnauthorized()),e(Object(v.d)(t))},N=function(e){m.interceptors.request.use((function(e){return e}),(function(e){return Promise.reject(e)})),m.interceptors.response.use((function(e){return e}),(function(t){return t&&t.response&&t.response.status&&401===t.response.status&&k(e.dispatch),Promise.reject(t)}))},P=(r(134),r(36)),x=r(22),S=function(e){return e.auth.authorized},F=function(e){return e.auth.authRequested},C=function(e){return e.auth.login.error},R=function(e){return e.auth.login.inProcess},I=function(e){return e.auth.user},D=function(e){return e.auth.logout},z=r(41),U=r.n(z),q=r(77),M=function(e,t){var r,n;if(t.isAxiosError&&(null===(r=t.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.error)){var a=t.response.data.error;return{reason:a.key||e,details:a.message,error:t}}return{reason:e,error:t}},V=function(e,t){return e({type:"@@error/ERROR_OCCURRED",payload:t})},B=function(e){return m.get("/login/user").then((function(e){return e.data}))},T=function(e){return m.post("/login",e).then((function(e){return e.data}))},W=function(){return m.post("/logout").then((function(e){return e.data}))},L=function(e){var t=Object(i.e)(F),r=Object(i.d)();return Object(n.useEffect)((function(){!t&&r(function(e){return function(){var t=Object(q.a)(U.a.mark((function t(r){var n,a;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r(O.getCurrentUserProcess()),t.prev=1,t.next=4,B(e);case 4:n=t.sent,r(O.getCurrentUserSuccess(n)),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),a=M("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",t.t0),r(O.getCurrentUserFailed(a)),V(r,a);case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}()}(e))}),[t,r,e]),t},$=(r(136),r(72)),G=r(67),J=(r(137),r(3)),A=r.n(J),H=function(e){Object($.a)(r,e);var t=Object(G.a)(r);function r(){return Object(p.a)(this,r),t.apply(this,arguments)}return Object(b.a)(r,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.children;return a.a.createElement("div",{className:A()("public-page",t)},a.a.createElement("div",{className:"public-page__header header"},a.a.createElement("div",{className:"header__left"}),a.a.createElement("div",{className:"header__right"})),a.a.createElement("div",{className:"public-page__body"},r),a.a.createElement("div",{className:"public-page__footer footer"},a.a.createElement("div",{className:"footer__left"}),a.a.createElement("div",{className:"footer__right"})))}}]),r}(a.a.PureComponent);H.Message=function(e){var t=e.children,r=e.text,n=e.className;return a.a.createElement("div",{className:A()("public-page-message",n)},a.a.createElement("div",{className:"public-page-message__text"},t,r))};var K=H,Q=r(105),X=r(73);r(138);function Y(e){var t,r,n;return t=e,r=0,n=1,e=(Math.min(Math.max(r,t),n)-r)/(n-r),e=(e-=1)*e*e+1}var Z=a.a.forwardRef((function(e,t){var r,n=e.className,o=e.disableShrink,c=void 0!==o&&o,i=e.size,s=e.thickness,u=void 0===s?3.6:s,l=e.value,d=void 0===l?0:l,m=e.variant,f=void 0===m?"indeterminate":m,h=Object(X.a)(e,["className","disableShrink","size","thickness","value","variant"]),g={},v={},p={};if("determinate"===f||"static"===f){var b=2*Math.PI*((44-u)/2);g.strokeDasharray=b.toFixed(3),p["aria-valuenow"]=Math.round(d),"static"===f?(g.strokeDashoffset="".concat(((100-d)/100*b).toFixed(3),"px"),v.transform="rotate(-90deg)"):(g.strokeDashoffset="".concat((r=(100-d)/100,r*r*b).toFixed(3),"px"),v.transform="rotate(".concat((270*Y(d/70)).toFixed(3),"deg)"))}return a.a.createElement("div",Object.assign({className:A()("loading","indeterminate"===f?"loading_indeterminate":"static"===f&&"loading_static",c&&"loading_disable-shrink",n),style:Object(Q.a)({width:i,height:i},v),ref:t,role:"progressbar"},p,h),a.a.createElement("svg",{className:"loading__svg",viewBox:"".concat(22," ").concat(22," ").concat(44," ").concat(44)},a.a.createElement("circle",{className:"loading__circle",style:g,cx:44,cy:44,r:(44-u)/2,fill:"none",strokeWidth:u})))})),ee=function(){return a.a.createElement(K,{className:"loading-page"},a.a.createElement(K.Message,null,a.a.createElement(Z,{size:50})))};var te=function(e){var t=e.dataState,r=e.errorView,n=e.processView,o=e.children;return t.inProcess?n:t.error?r({message:t.error.reason}):a.a.createElement(a.a.Fragment,null,t.data?o({data:t.data}):null)},re=(r(139),function(e){var t=e.message;return a.a.createElement(K,{className:"error-page"},a.a.createElement(K.Message,null,a.a.createElement("h1",{className:"error-page__title"},"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a"),t?a.a.createElement("h1",{className:"error-page__text"},t):a.a.createElement("span",{className:"error-page__text"},"\u041c\u044b \u0443\u0436\u0435 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u043c \u043d\u0430\u0434 \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u044d\u0442\u043e\u0439 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b!")))}),ne=function(e){var t=Object(i.e)(S),r=Object(i.e)(I);return L(!0),t?a.a.createElement(x.a,e):a.a.createElement(x.a,Object.assign({},e,{component:void 0,render:function(){return a.a.createElement(te,{dataState:r,processView:a.a.createElement(ee,null),errorView:function(e){var t=e.message;return a.a.createElement(re,{message:t})}},(function(){return a.a.createElement(ee,null)}))}}))},ae=function(e){Object($.a)(r,e);var t=Object(G.a)(r);function r(e){var n;return Object(p.a)(this,r),(n=t.call(this,e)).state={hasError:!1},n}return Object(b.a)(r,[{key:"componentDidCatch",value:function(e,t){console.error("Catch error",e,t)}},{key:"render",value:function(){return this.state.hasError?a.a.createElement(re,null):this.props.children}}],[{key:"getDerivedStateFromError",value:function(){return{hasError:!0}}}]),r}(a.a.Component),oe=(r(141),function(e){return e.router.location.search}),ce=function(){var e=Object(i.e)(S),t=Object(i.e)(oe),r=Object(i.d)();return Object(n.useEffect)((function(){var n=function(e,t){t||(t=window.location.href),e=e.replace(/[\]]/g,"\\$&");var r=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""}("continue",t);e&&(n?window.location.href=n:r(Object(v.d)("/")))}),[e,t,r]),e},ie=(r(142),r(68)),se=r(78),ue=r(40),le=function(e){return e.toString()};var de=r(104),me=function(e){var t=Object(ie.b)(e),r=Object(de.a)(t,2),n=r[0],o=r[1],c=e.id,i=e.type,s=e.placeholder,u=e.as,l=e.label,d=e.readonly,m=e.className,f=e.disableFeedback;return a.a.createElement(ue.a.Group,{className:A()(m),controlId:c},l&&a.a.createElement(ue.a.Label,null,l),a.a.createElement(ue.a.Control,{plaintext:!!d,type:i,as:u,name:n.name,placeholder:s,onChange:n.onChange,onBlur:n.onBlur,value:n.value,isInvalid:o.touched&&!!o.error},e.children),!f&&a.a.createElement(ue.a.Control.Feedback,{type:"invalid"},o.error))},fe=(r(146),r(70)),he=function(e){var t=e.loading,r=e.children,n=Object(X.a)(e,["loading","children"]);return a.a.createElement(fe.a,Object.assign({},n,{disabled:!!t||n.disabled}),t?a.a.createElement(Z,{className:"loading-button__spinner"}):r)},ge=function(e){var t=e.handleSubmit,r=e.errors,n=e.touched,o=Object(i.e)(R),c=Object(i.e)(C);return a.a.createElement("div",{className:"login-form"},a.a.createElement("div",{className:"login-form__container"},a.a.createElement("h1",{className:"login-form__title"},"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f"),a.a.createElement(ue.a,{noValidate:!0,onSubmit:t},a.a.createElement(me,{className:"login-form__login",id:"loginFormLogin",type:"text",name:le("login"),placeholder:"E-mail",disableFeedback:!0}),a.a.createElement(me,{className:"login-form__password",id:"loginFormPassword",type:"password",name:le("password"),placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",disableFeedback:!0}),a.a.createElement(he,{type:"submit",className:"login-form__submit",variant:"outline-light",loading:o},"\u0414\u0430\u043b\u0435\u0435"),a.a.createElement(fe.a,{className:"login-form__submit",variant:"outline-light"},"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"),a.a.createElement("div",{className:"login-form__error-container"},function(e,t){return Object.keys(e).map((function(e){return t[e]}))}(n,r).map((function(e,t){return a.a.createElement("h2",{key:t,className:"login-form__error"},e)})),c&&a.a.createElement("h2",{className:"login-form__error"},c.reason&&c.reason)))))},ve=function(){var e=Object(i.d)();return a.a.createElement(ie.a,{initialValues:{login:"",password:""},validationSchema:se.a().shape({login:se.b().required("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 Email"),password:se.b().required("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c")}),onSubmit:function(t){var r;e((r=t,function(){var e=Object(q.a)(U.a.mark((function e(t){var n;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(O.loginProcess()),e.prev=1,e.next=4,T(r);case 4:t(O.loginSuccess()),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),n=M("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0432\u0445\u043e\u0434",e.t0),t(O.loginFailed(n)),V(t,n);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()))}},(function(e){return a.a.createElement(ge,e)}))},pe=function(){var e=ce(),t=L(!1),r=Object(i.e)(I).inProcess;return e||r||!t?a.a.createElement(ee,null):a.a.createElement(K,{className:"login"},a.a.createElement(ve,null))},be=(r(147),r(152)),Ee=function(){var e=Object(i.e)(D).inProcess,t=Object(i.d)(),r=Object(n.useCallback)((function(){return t(function(){var e=Object(q.a)(U.a.mark((function e(t){var r;return U.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(O.logoutProcess()),e.prev=1,e.next=4,W();case 4:t(O.logoutSuccess()),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(1),r=M("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0432\u044b\u0445\u043e\u0434",e.t0),t(O.logoutFailed(r)),V(t,r);case 12:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}())}),[t]);return a.a.createElement(be.a,{fluid:!0,className:"home"},a.a.createElement("section",{className:"home__message"},"\u0412\u044b \u0437\u0430\u0448\u043b\u0438 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0443"),a.a.createElement(he,{onClick:r,loading:e,variant:"outline-light"},"\u0412\u044b\u0439\u0442\u0438"))},_e=r(85),we=(r(149),function(){return a.a.createElement("div",{className:"mobile-only"},a.a.createElement("h1",null,"\u0412\u0435\u0431-\u0441\u0430\u0439\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u0442\u043e\u043b\u044c\u043a\u043e \u0441 \u043c\u043e\u0431\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"))}),ye=function(e){var t=e.history,r=e.context;return a.a.createElement(ae,null,a.a.createElement(P.a,{history:t,context:r},a.a.createElement(_e.BrowserView,null,a.a.createElement(we,null)),a.a.createElement(_e.MobileView,null,a.a.createElement(x.c,null,a.a.createElement(x.a,{path:"/login",component:pe}),a.a.createElement(ne,{exact:!0,path:"/",component:Ee})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var je=r(25),Oe=r(97),ke=r(55),Ne=r(15),Pe=function(e){return Object(Ne.c)({router:Object(P.b)(e),auth:j})},xe=Object(je.a)({basename:"/"}),Se=Object(Oe.a)(xe),Fe=Object(_.a)({reducer:Pe(xe),middleware:[Se,ke.a],devTools:!1});N(Fe),c.a.render(a.a.createElement(i.a,{store:Fe},a.a.createElement(ye,{history:xe,context:i.b})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[106,1,2]]]);
//# sourceMappingURL=main.b4536131.chunk.js.map